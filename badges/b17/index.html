<!DOCTYPE html>
<meta charset="utf-8">
<body>
<script src="../../d3.js"></script>
<style>
html, body {
  width: 100%;
  height: 100%;
  overflow: hidden;
  margin: 0;
  padding: 0;
  background-color: #333;
}
canvas{
  /*background-color: white;*/
}
svg{
  /*background-color: white;*/
}
</style>
<script>

// originally from: bl.ocks.org/RandomEtc/5165219

var w = 1050,
    h = 1500

var width = w, height = h

var x1 = width / 2,
    y1 = height / 2,
    x0 = x1,
    y0 = y1,
    i = 0,
    r = width / 1,
    τ = 2 * Math.PI;

var canvas = d3.select("body").append("canvas")
    .attr("width", width)
    .attr("height", height)

var context = canvas.node().getContext("2d");
context.globalCompositeOperation = "lighter";
context.lineWidth = 4;

var circle_steps = []
function original_step(){
  context.clearRect(0, 0, width, height);

  var z = d3.hsl(++i % 360, 1, .5).rgb(),
      c = "rgba(" + z.r + "," + z.g + "," + z.b + ",",
      x = x0 += (x1 - x0) * .1,
      y = y0 += (y1 - y0) * .1;

  circle_steps.push((function(){
    var i = 0
    var t = 0
    return function(){
      t = Math.sqrt(i / 100) / 1
      context.strokeStyle = c + (1 - t) + ")";
      context.beginPath();
      context.arc(x, y, r * t, 0, τ);
      context.stroke();
      i++
    }
  })())
  circle_steps.forEach(function(f){ f() })
}

var steps = 0
function step() {
  if(steps++ > 10) return
  for(var i = 0; i < 30; i++) original_step()
}

is_ready = true

;(function(){
  if(!window.step) window.step = null
  // debuggin snippet for when not in an iframe
  if(window.self !== window.top) return
  ;(function check(){ if(!is_ready) return setTimeout(check, 100); setInterval(step, 100) })()
})()

</script>